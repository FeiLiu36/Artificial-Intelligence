# 主成分分析

> Principal Component Analysis (PCA)
>



## 概述

将 $n$ 维特征映射到 $k$ 维，这 $k$ 维是相互正交的，每一维就是一个轴方向，

（[维基百科](https://zh.wikipedia.org/wiki/%E4%B8%BB%E6%88%90%E5%88%86%E5%88%86%E6%9E%90)）降维算法之一，为了保留数据中对<u>方差</u>贡献最大的特征。它利用正交变换来对一系列可能相关的变量的观测值进行线性变换，从而投影为一系列线性不相关变量的值，这些不相关变量称为主成分。

把数据变换到一个新的坐标系/基（坐标轴正交）中去，第一个坐标轴上的方差最大，第二个坐标轴次之，依次类推

## 图解例子







## 理论推导

目前有两种主流的解释：

- 最大方差理论
- 最小化降维造成的损失



### 最大方差理论

先介绍一下信噪比

> 在信号处理中存在**原始信号**和**噪声**两种
>
> 1. 噪声产生：处理过程中设备自行产生的，与原始信号无关，没原始信号时，就存在这样的噪声
>
> 2. 噪声特性：无规律，不随原始信号的变化而变化
>
> 3. 我们的目的：希望尽可能的只有原始信号，而没有噪声
> 4. 引入信噪比：=原始信号/噪声，音频信号一般用功率，其他信号一般用方差
>
> 5. 结论：信噪比越大，说明混在原始信号里的**噪声影响越小**，相比较而言**原始信号**具有**较大**的方差，**噪声**具有**较小**的方差



我们在找主成分的时候，就是要找到原始信号，去除噪声；因此就是要找到在某一方向上，信号的方差最大，被认为是原始信号



我们将数据建模为：



$N$ 个数据 $X = \{x^{(1)}, x^{(2)}, \dots, x^{(N)}\}$，其中每一个都是 $M$ 维的向量
$$
X=\left(\begin{array}{llll}
x^{(1)}_1 & x^{(2)}_1 & \cdots & x^{(N)}_1 \\
x^{(1)}_2 & x^{(2)}_2 & \cdots & x^{(N)}_2 \\
& & \dots \\
x^{(1)}_M & x^{(2)}_M & \cdots & x^{(N)}_M
\end{array}\right)
$$
我们希望将它降到 $K$ 维，也就是找到 $M$ 维中前 $K$ 个重要维度。如果把每一维都看作是一个特征的话，就是要找到哪几个特征是最重要的，最明显的。



数据 $X$ 的协方差矩阵
$$
XX^{\mathsf{T}} = \left(\begin{array}{llll}
\sum_{i=1}^N {x^{(i)}_1}^2 & \sum_{i=1}^N {x^{(i)}_1}{x^{(i)}_2} & \cdots & \sum_{i=1}^N {x^{(i)}_1}{x^{(i)}_M} \\
\sum_{i=1}^N {x^{(i)}_2}{x^{(i)}_1} & \sum_{i=1}^N {x^{(i)}_2}^2 & \cdots & \sum_{i=1}^N {x^{(i)}_2}{x^{(i)}_M} \\
& & \dots \\
\sum_{i=1}^N {x^{(i)}_M}{x^{(i)}_1} & \sum_{i=1}^N {x^{(i)}_M}{x^{(i)}_2} & \cdots & \sum_{i=1}^N {x^{(i)}_M}^2
\end{array}\right)
$$
这是一个对称矩阵，其对角线分别为所有数据各个维度的方差，其余为不同维度之间的协方差



根据我们的目标，是要做一个变换 $Y=AX$，其中 $A$ 就是我们要找的基矩阵



我们再写出新数据的协方差矩阵 $Y Y^{\mathsf{T}} = AX (AX)^{\mathsf{T}} = A (X X^{\mathsf{T}}) A^{\mathsf{T}}$



还是别忘记我们的目标，我们希望新数据**协方差为0，而方差最大**，也就是希望 $Y Y^{\mathsf{T}}$ 是一个对角矩阵，且对角线上元素最大

即形如：
$$
Y Y^{\mathsf{T}}=\left(\begin{array}{llll}
\lambda_1 & 0 & \cdots & 0 \\
0 & \lambda_1 & \cdots & 0 \\
& & \dots \\
0 & 0 & \cdots & \lambda_K
\end{array}\right)
$$
这就让我们联想到了矩阵的特征值分解，一个矩阵可以分解为特征向量和特征值，其中特征向量是相互正交的，这正好符合我们的要求









原数据的协方差矩阵 $XX^{\mathsf{T}}$ 是一个**对称矩阵** 

做变换 $Y=AX$, （其中 $A$ 是一个基矩阵）

新数据的协方差矩阵 $YY^{\mathsf{T}} = A(XX^{\mathsf{T}})A^{\mathsf{T}}$ 得是一个**对角矩阵**

就可以根据 $XX^{\mathsf{T}}$ 求解 $A$ 



## 实现

1. 将坐标轴中心移到数据的中心，然后旋转坐标轴，使得数据在C1轴上的方差最大，即全部数据个体在该方向上的投影最为分散。C1成为第一主成分。
2. 找一个C2，使得C2与C1的协方差（相关系数）为0，以免与C1信息重叠，并且使数据在该方向的方差尽量最大。
3. 以此类推，找到第三主成分，第四主成分……第k个主成分



[代码]()

### 如何确定主成分个数$K$



数据整体方差：$\frac{1}{N} \sum_{i=1}^N \|x^{i}\|^2$

数据映射方差：$\frac{1}{N} \sum_{i=1}^N \|x^{i} - x^{i}_{projection}\|^2$


$$
\frac{\frac{1}{N} \sum_{i=1}^N \|x^{i} - x^{i}_{projection}\|^2}{\frac{1}{N} \sum_{i=1}^N \|x^{i}\|^2} \le t
$$




$$
\min L = f(V(x))^2 \\
s.t. V(\mathbf{x}) = 0
$$
