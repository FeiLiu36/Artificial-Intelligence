# 形变和应变

> Deformations and Strain
>
> Continuum Mechanics



displacements 位移

deformations 形变

stress 应力

strain 张力



第一步量化物体的位移和形变

从形变中分离开位移

**形变与位移场的梯度密切相关**



形变包括

- bending 弯曲
- twisting 扭曲
- stretching 拉伸
- rotation 旋转
- shearing 剪切



## 变形梯度

Deformation Gradient

符号说明

$\mathbf{X}$ 是没形变的参考向量，$\mathbf{x}$ 是形变后的向量，$\mathbf{F}$ 是形变的梯度


$$
F_{ij} = \frac{\partial x_{i}}{\partial X_{j}}
$$

$u = x- X$

一些简单形变的例子



**例1 - 拉伸**

<img src="https://www.continuummechanics.org/images/defgradient/2and15stretch.svg"/>
$$
\begin{array}{l}
x=2.0 X+0.0 Y \\
y=0.0 X+1.5 Y
\end{array}
$$






使用极分解，将变形分解为旋转和拉伸
$$
F = V R = R U
$$

$$
V = R U R^T
$$

R 是旋转矩阵，U 和 V 是对称矩阵，





刚体旋转：
$$
\begin{array}{l}
x=X \cos \theta-Y \sin \theta \\
y=X \sin \theta+Y \cos \theta
\end{array}
$$




左右柯西-格林公式
$$
F^T F= U^2
$$

$$
F F^T = V^2
$$




---

在几何处理和物理仿真中，经常用**弹性能量**对**非刚体变形**进行建模，目的是为了测量局部变形与刚性运动的偏差。

在视觉领域，这些能量被广泛应用于非刚性场景和物体的重建和跟踪







刚体位移 是物体的平行移动或旋转，而形状和大小没有变化。

变形 是





## 二维

旋转矩阵：
$$
\mathbf{R}=\left[\begin{array}{lr}
\cos \theta & -\sin \theta \\
\sin \theta & \cos \theta
\end{array}\right]
$$


具有性质：
$$
\mathbf{R} \cdot \mathbf{R}^{T}=\mathbf{I}
$$






## 三维

旋转矩阵
$$
\mathbf{R}=\left[\begin{array}{lll}
\cos \left(x^{\prime}, x\right) & \cos \left(y^{\prime}, x\right) & \cos \left(z^{\prime}, x\right) \\
\cos \left(x^{\prime}, y\right) & \cos \left(y^{\prime}, y\right) & \cos \left(z^{\prime}, y\right) \\
\cos \left(x^{\prime}, z\right) & \cos \left(y^{\prime}, z\right) & \cos \left(z^{\prime}, z\right)
\end{array}\right]
$$
三维如果固定一维（例如z）
$$
\mathbf{R}=\left[\begin{array}{ccc}
\cos \theta & -\sin \theta & 0 \\
\sin \theta & \cos \theta & 0 \\
0 & 0 & 1
\end{array}\right]
$$
如果是三维的连续旋转，会有一个Roe准则（Roe Convention）

> 先关于原z轴旋转 $\psi$，再关于新y轴旋转 $\theta$，再关于新z轴旋转 $\phi$

$$
\begin{aligned}
\mathbf{R} 
&=\left[\begin{array}{ccc}
\cos \psi & -\sin \psi & 0 \\
\sin \psi & \cos \psi & 0 \\
0 & 0 & 1
\end{array}\right]\left[\begin{array}{ccc}
\cos \theta & 0 & \sin \theta \\
0 & 1 & 0 \\
-\sin \theta & 0 & \cos \theta
\end{array}\right]\left[\begin{array}{ccc}
\cos \phi & -\sin \phi & 0 \\
\sin \phi & \cos \phi & 0 \\
0 & 0 & 1
\end{array}\right] \\
&=\left[\begin{array}{ccc}
\cos \psi \cos \theta \cos \phi-\sin \psi \sin \phi & -\cos \psi \cos \theta \sin \phi-\sin \psi \cos \phi & \cos \psi \sin \theta \\
\sin \psi \cos \theta \cos \phi+\cos \psi \sin \phi & -\sin \psi \cos \theta \sin \phi+\cos \psi \cos \phi & \sin \psi \sin \theta \\
-\sin \theta \cos \phi & \sin \theta \sin \phi & \cos \theta
\end{array}\right]
\end{aligned}
$$

已知R，也可以把角度都算出来

---



考虑应力
$$
\boldsymbol{\epsilon}=\left[\begin{array}{lll}
\epsilon_{11} & \epsilon_{12} & \epsilon_{13} \\
\epsilon_{12} & \epsilon_{22} & \epsilon_{23} \\
\epsilon_{13} & \epsilon_{23} & \epsilon_{33}
\end{array}\right]
$$

$$
\boldsymbol{\epsilon}=\frac{1}{2}\left(\mathbf{F}+\mathbf{F}^{T}\right)-\mathbf{I}
$$
如果没有刚体旋转，则
$$
\boldsymbol{\epsilon}=\mathbf{U}-\mathbf{I}
$$


格林应力
$$
\mathbf{E}=\frac{1}{2}\left(\mathbf{F}^{T} \cdot \mathbf{F}-\mathbf{I}\right)
$$




## 弹性能量

因为变形，系统存储了弹性势能 (elastic potential energy)，当外力使物体位移或变形时，能量通过功转移到物体上。
$$
f\left(\varepsilon_{i j}\right)=\frac{1}{2} \lambda \varepsilon_{i i}^{2}+\mu \varepsilon_{i j}^{2}
$$

$$
\boldsymbol{\epsilon}=\frac{1}{2}\left(\mathbf{F}+\mathbf{F}^{T}\right)-\mathbf{I}
$$

$$
\epsilon_{i j}=\frac{1}{2}\left(u_{i, j}+u_{j, i}\right)
$$




$$
\boldsymbol{\epsilon}=\left[\begin{array}{ccc}
\frac{\partial u_{x}}{\partial X} & \frac{1}{2}\left(\frac{\partial u_{x}}{\partial Y}+\frac{\partial u_{y}}{\partial X}\right) & \frac{1}{2}\left(\frac{\partial u_{x}}{\partial Z}+\frac{\partial u_{z}}{\partial X}\right) \\
& \frac{\partial u_{y}}{\partial Y} & \frac{1}{2}\left(\frac{\partial u_{y}}{\partial Z}+\frac{\partial u_{z}}{\partial Y}\right) \\
\operatorname{sym} & & \frac{\partial u_{z}}{\partial Z}
\end{array}\right]
$$


因为U-I很难计算，所以提出格林应力
$$
\mathbf{E}=\left[\begin{array}{lll}
E_{x x} & E_{x y} & E_{x z} \\
E_{x y} & E_{y y} & E_{y z} \\
E_{x z} & E_{y z} & E_{z z}
\end{array}\right]
$$

$$
\begin{array}{l}
E_{x x}=\frac{\partial u}{\partial X}+\frac{1}{2}\left[\left(\frac{\partial u}{\partial X}\right)^{2}+\left(\frac{\partial v}{\partial X}\right)^{2}+\left(\frac{\partial w}{\partial X}\right)^{2}\right] \\
E_{y y}=\frac{\partial v}{\partial Y}+\frac{1}{2}\left[\left(\frac{\partial u}{\partial Y}\right)^{2}+\left(\frac{\partial v}{\partial Y}\right)^{2}+\left(\frac{\partial w}{\partial Y}\right)^{2}\right] \\
E_{z z}=\frac{\partial w}{\partial Z}+\frac{1}{2}\left[\left(\frac{\partial u}{\partial Z}\right)^{2}+\left(\frac{\partial v}{\partial Z}\right)^{2}+\left(\frac{\partial w}{\partial Z}\right)^{2}\right] \\
E_{x y}=\frac{1}{2}\left(\frac{\partial u}{\partial Y}+\frac{\partial v}{\partial X}\right)+\frac{1}{2}\left[\frac{\partial u}{\partial X} \frac{\partial u}{\partial Y}+\frac{\partial v}{\partial X} \frac{\partial v}{\partial Y}+\frac{\partial w}{\partial X} \frac{\partial w}{\partial Y}\right] \\
E_{y z}=\frac{1}{2}\left(\frac{\partial u}{\partial Z}+\frac{\partial w}{\partial X}\right)+\frac{1}{2}\left[\frac{\partial u}{\partial X} \frac{\partial u}{\partial Z}+\frac{\partial v}{\partial X} \frac{\partial v}{\partial Z}+\frac{\partial w}{\partial X} \frac{\partial w}{\partial Z}\right] \\
\\
\\
\end{array}
$$




刻画能量的方法有：



1. 用旋转矩阵 (closest rotation)，为了刻画 how far is from an isometry

$$
L_{\text {elastic }}(\mathbf{x}) = \left\|\mathbf{J}_{T}-\mathbf{R}\right\|_{F}^{2}
$$

where $\mathbf{J}_T=\mathbf{R} \mathbf{U}$

2. 用拉伸矩阵

$$
L_{\text {elastic }}(\mathbf{x})=\|\mathbf{U}-\mathbf{I}\|_{F}^{2}
$$

where $\mathbf{J}_T=\mathbf{R} \mathbf{U}$

3. 用格林应力 (Green strain)

$$
L_{\text {elastic }}(\mathbf{x}) = \left\|\mathbf{J}_{T} \mathbf{J}_{T}^{\mathsf{T}} -\mathbf{I}\right\|_{F}^{2}
$$

4. 用奇异值 (singular values)

$$
L_{\text {elastic }}(\mathbf{x})=\|\mathbf{\Sigma}-\mathbf{I}\|_{F}^{2}
$$

where $\mathbf{J}_{T}=\mathbf{U} \boldsymbol{\Sigma} \mathbf{V}^{T}$



对这三种都可以尝试取矩阵对数 $\log$







## 参考

This [website](https://www.continuummechanics.org/deformationstrainintro.html) presents the principles of finite deformation continuum mechanics with many example applications. -- by **Bob McGinty**



文献

- https://dl.acm.org/doi/pdf/10.1145/2601097.2601116
- 